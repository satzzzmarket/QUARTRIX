<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Dashboard - QUARTRIX</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
  <h1>QUARTRIX</h1>
  <button onclick="logout()">Logout</button>
</header>

<main>
  <div class="card">
    <p id="info"></p>
  </div>

  <div class="card" id="adminPanel" style="display:none;">
    <h3>Tambah Siswa (Admin)</h3>
    <input type="text" id="namaBaru" placeholder="Nama Lengkap">
    <input type="number" id="absenBaru" placeholder="Nomor Absen">
    <button onclick="tambahSiswa()">Tambah</button>
  </div>

  <div class="card">
    <h3>Daftar Siswa</h3>
    <ul id="siswaList"></ul>
  </div>
</main>

<script>
/* CEK LOGIN */
const role = localStorage.getItem("role");
const namaLogin = localStorage.getItem("nama");
const absenLogin = localStorage.getItem("absen");

if (!role) {
  window.location.href = "login.html";
}

/* DATA */
let akunData = JSON.parse(localStorage.getItem("akunData")) || [
  { nama: "ADMIN", absen: "admin123", role: "admin" }
];

let siswaData = JSON.parse(localStorage.getItem("siswaData")) || [
  { nama: "AGUSTINE DYAH AYU RAHMADANI", absen: 1 },
  { nama: "AHMAD FAISHAL ZAUMAR", absen: 2 },
  { nama: "ALANA GEIZEL FAEDAH ALAM", absen: 3 },
  { nama: "ALYA NAFEEZA AZZAHRO", absen: 4 },
  { nama: "ANNISA PRIMADITA MUSAFA", absen: 5 },
  { nama: "ARYA ISSYA MAHENDRA", absen: 6 },
  { nama: "BERLIANA FAIRUZ IZDIHAR", absen: 7 },
  { nama: "CLEON ADLI DANENDRA OMAN", absen: 8 },
  { nama: "EIVEL FLORAYSA NADINDA ARDYALOVA", absen: 9 },
  { nama: "EVELYN GABRIEL ECHA CARERA", absen: 10 },
  { nama: "EZHAR AIRLANGGA RISTANSYAH", absen: 11 },
  { nama: "FALIA PUTRI ELLYZA", absen: 12 },
  { nama: "HANINDIA ASYAWA KAYNAHAYA", absen: 13 },
  { nama: "HANUNG ELYA PINANDITA", absen: 14 },
  { nama: "HELMY ARSYAD DARMAWAN", absen: 15 },
  { nama: "HENDARSO WIRATMOKO", absen: 16 },
  { nama: "JAGAD CAHYO ADY", absen: 17 },
  { nama: "JESSICA AFA MARTANIA", absen: 18 },
  { nama: "KAYLA AMANDA SYAMSAFINA", absen: 19 },
  { nama: "KEVIN APRILIO", absen: 20 },
  { nama: "LINTANG YULIDHA PUTRI", absen: 21 },
  { nama: "MUHAMMAD IBNU KHALDUN ALFAUZI", absen: 22 },
  { nama: "NABIL MAHIDARA ARTANTO", absen: 23 },
  { nama: "NABILA KIRANA CANTYA PUTRI", absen: 24 },
  { nama: "NADIA REYSSA IRVANA PUTRI", absen: 25 },
  { nama: "NATHANAEL ABIRA SETYO BUDI", absen: 26 },
  { nama: "NATHANIA NARESWARI BRAHMA PUTRI", absen: 27 },
  { nama: "NIDA ULHAQ NUR SYIFA", absen: 28 },
  { nama: "NISRINA MARYAM", absen: 29 },
  { nama: "PHILLIPUS ADE MAHENDRA PUTRA", absen: 30 },
  { nama: "PRISYA NOVI ANGGRAENI", absen: 31 },
  { nama: "RENITA ISNABILA", absen: 32 },
  { nama: "SEDYO SAKA PRATAMA", absen: 33 },
  { nama: "SELLA RAHMA YUNANDA", absen: 34 }
];

/* INFO */
const info = document.getElementById("info");
const adminPanel = document.getElementById("adminPanel");
const siswaList = document.getElementById("siswaList");

if (role === "admin") {
  info.innerText = "Login sebagai ADMIN";
  adminPanel.style.display = "block";
} else {
  info.innerText = "Selamat datang, " + namaLogin + " (Absen " + absenLogin + ")";
}

/* RENDER */
function renderSiswa() {
  siswaList.innerHTML = "";
  siswaData.sort((a,b)=>a.absen-b.absen);
  siswaData.forEach(s => {
    const li = document.createElement("li");
    li.innerText = "Absen " + s.absen + " - " + s.nama;
    siswaList.appendChild(li);
  });
  localStorage.setItem("siswaData", JSON.stringify(siswaData));
  localStorage.setItem("akunData", JSON.stringify(akunData));
}
renderSiswa();

/* TAMBAH */
function tambahSiswa() {
  const nama = document.getElementById("namaBaru").value.trim().toUpperCase();
  const absen = document.getElementById("absenBaru").value.trim();

  if (!nama || !absen) return alert("Lengkapi data");
  if (siswaData.some(s => s.absen == absen)) return alert("Absen sudah ada");

  siswaData.push({ nama, absen:Number(absen) });
  akunData.push({ nama, absen, role:"siswa" });

  renderSiswa();
  alert("Siswa berhasil ditambahkan");
}

/* LOGOUT */
function logout() {
  localStorage.clear();
  window.location.href = "login.html";
}
</script>

</body>
</html>
